var tfcjs=function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t),a.d(t,"utils",(function(){return U})),a.d(t,"builders",(function(){return L})),a.d(t,"ajax",(function(){return V})),a.d(t,"forms",(function(){return _})),a.d(t,"vindicateForm",(function(){return H}));var n={};a.r(n),a.d(n,"buildModal",(function(){return c})),a.d(n,"buildSwitchGroup",(function(){return u}));var o={};a.r(o),a.d(o,"debounce",(function(){return f})),a.d(o,"flashError",(function(){return m})),a.d(o,"flashMessage",(function(){return p})),a.d(o,"getFileIconClass",(function(){return h})),a.d(o,"getFilename",(function(){return g})),a.d(o,"getRandomString",(function(){return v})),a.d(o,"onImageLoad",(function(){return C})),a.d(o,"scrollTo",(function(){return y})),a.d(o,"scrollElementToBottom",(function(){return x})),a.d(o,"stripPhone",(function(){return w})),a.d(o,"tabBlinker",(function(){return E})),a.d(o,"toggleIcon",(function(){return I})),a.d(o,"updateUrl",(function(){return j}));var r={};a.r(r),a.d(r,"clearForm",(function(){return k})),a.d(r,"collectInputVals",(function(){return S})),a.d(r,"populateForm",(function(){return T})),a.d(r,"pythonizeData",(function(){return A})),a.d(r,"removeVindicateFeedback",(function(){return D}));var l={};a.r(l),a.d(l,"tfcAjax",(function(){return P})),a.d(l,"tfcGet",(function(){return O})),a.d(l,"tfcPost",(function(){return F}));var i={};a.r(i),a.d(i,"VINDICATE_OPTIONS",(function(){return M})),a.d(i,"EVENTS",(function(){return N})),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return void 0===t&&(t=0),-1!==this.indexOf(e,t)});const s={bodyClass:null,bodyHtml:null,contentClass:null,fade:!0,footerClass:null,hasFooter:!1,hasHeader:!1,headerClass:null,headerIconClass:null,modalClass:null,modalId:"custom-modal",scrollable:!0,size:null,title:null},d={checked:!1,groupClass:null,inputClass:null,inputId:null,label:"Toggle",name:null,value:null};function c(e){if(!(e=Object.assign(Object.assign({},s),e||{})).modalId)throw"modalId required. Got "+e.modalId.toString();let t=null,a=null,n=e.modalId||s.modalId,o=1;for(;$("#"+n).length;)n=e.modalId+"-"+o++;const r=e.title?n+"-title":null;return(e.title||e.headerIconClass||e.headerClass)&&(e.hasHeader=!0),console.debug(e),e.hasHeader&&(t=$("<header>").addClass("modal-header").addClass(e.headerClass),e.title&&(t.append($("<h5>").attr("id",r).addClass("modal-title")),e.headerIconClass&&$("h5",t).append($("<i>").addClass("fai "+e.headerIconClass)).append("&ensp;"),$("h5",t).append(e.title)),t.append($("<button>").attr("type","button").addClass("close").attr("data-dismiss","modal").attr("aria-label","Close").append($("<span>").attr("aria-hidden","true").append("&times;")))),e.hasFooter&&(a=$("<footer>").addClass("modal-footer").addClass(e.footerClass)),console.debug(t),console.debug(a),$("<div>").addClass("modal").addClass(e.modalClass).addClass(e.fade?"fade":null).attr("id",n).attr("tabindex","-1").attr("role","dialog").attr("aria-labelledby",r).attr("aria-hidden","true").append($("<div>").addClass("modal-dialog").addClass(e.scrollable?"modal-dialog-scrollable":null).addClass(e.size?"modal-"+size:null).attr("role","document").append($("<div>").addClass("modal-content").append(t).append($("<div>").addClass("modal-body").append(e.bodyHtml)).append(a)))}function u(e){return e=Object.assign(Object.assign({},d),e||{}),console.debug("switch options",e),$("<div>").addClass("switch-group").addClass(e.groupClass).append($("<label>").attr("for",e.inputId).addClass("switch").append($("<input>").attr("id",e.inputId).attr("type","checkbox").addClass(e.inputClass).val(e.value).attr("name",e.name)).append($("<div>").addClass("switch-slider"))).append($("<label>").attr("for",e.inputId).text(e.label))}function f(e,t,a){var n;return function(){var o=this,r=arguments;clearTimeout(n),n=setTimeout((function(){n=null,a||e.apply(o,r)}),t),a&&!n&&e.apply(o,r)}}function m(e,t,a){const n=c({bodyHtml:e,headerIconClass:a=a||"far fa-exclamation-triangle",modalClass:"tfcjs-flash-modal tfcjs-flash-error-modal",modalId:"js-flash-error-modal",title:t=t||"Error"});$("body").append(n),n.modal("show")}function p(e,t,a){const n=c({bodyHtml:e,headerIconClass:a=a||"far fa-info-circle",modalClass:"tfcjs-flash-modal tfcjs-flash-message-modal",modalId:"js-flash-message-modal",title:t=t||"Message"});$("body").append(n),n.modal("show")}function h(e,t){const a=t?"-o":"";let n="fa-file";return e?("."==e[0]&&(e=e.slice(1)),e=e.toLowerCase(),["doc","docx"].includes(e)?n="fa-file-word":"pdf"==e?n="fa-file-pdf":["xls","xlsb","xlsm","xlsx"].includes(e)?n="fa-file-excel":["zip","rar","gz"].includes(e)?n="fa-file-archive":["ppt","pptm","pptx"].includes(e)?n="fa-file-powerpoint":"txt"==e?n="fa-file-text":["jpg","jpeg","png","bmp","gif","svg","tif","tiff","psd"].includes(e)?n="fa-file-image":["mp3","m4a","wav","flac","mp2"].includes(e)?n="fa-file-audio":["mp4","avi","mpeg","mpg"].includes(e)?n="fa-file-video":["py","php","js","html","htm","css","scss","sass","json","xml","xhtml","c","cpp","cgi","swf","dll","java","cs","asp","aspx"].includes(e)&&(n="fa-file-code"),n+a):n}function g(e){if(!e)return"";const t=e.split("/");return t[t.length-1]}function v(e){e=e||5;const t=new Uint32Array(e);return window.crypto.getRandomValues(t),Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}function b(e){for(var t=e.offsetParent(),a=e.position().top;t&&!t.offsetParent().hasClass("scrollable");)a+=t.position().top,t=t.offsetParent();return a}function C(e,t,a){e.complete?t():(t&&e.addEventListener("load",t),a&&e.addEventListener("error",a))}function y(e,t,a){const n=$("body>header"),o=e.parents(".scrollable"),r=10+(a?0:n.height());t=t||500,o.length>0?o.animate({scrollTop:b(e)},t):$([document.documentElement,document.body]).animate({scrollTop:e.offset().top-r},t)}function x(e){e&&e.constructor.prototype.jquery&&(e=e[0]),e.scrollTop=e.scrollHeight}function w(e){return e?e.replace(/[^\d]/g,""):""}const E=function(){const e=document.title;let t=null,a=null,n=!1;return{blink:function(o,r,l){l=l||1e3;const i=function(){clearInterval(a),document.title=e,window.onmousemove=null,a=null,n=!1};a||(n=!0,a=setInterval((function(){document.title=document.title==o?e:o}),l),r&&(t=window.onmousemove,window.onmousemove=i))},get blinking(){return n},cancel:function(){a&&clearInterval(a),document.title=e,window.onmousemove=t,t=null,n=!1}}}();function I(e,t,a){"object"==typeof e&&e&&e.jquery&&(e=e[0]),a=Object.assign({mockDisable:!1,noDisable:!1,icon:"far fa-sync",placement:"left"},a||{});const n=e.querySelector("i[class*=fa-]");if(t){if(e.disabled||e.classList.contains("disabled"))return;if(a.mockDisable?e.classList.add("disabled"):a.noDisable||(e.disabled=!0),n)e.dataset.originalIcon=n.className,n.className="fai fa-spin "+a.icon;else{let t=document.createElement("i");if(t.className="fai fa-spin "+a.icon,"left"===a.placement){let a=e.firstChild;e.insertBefore(t,e.firstChild),e.insertBefore(document.createTextNode(" "),a)}else{if("right"!==a.placement)throw"Invalid value for placement: "+a.placement;e.appendChild(document.createTextNode(" ")),e.appendChild(t)}}}else a.mockDisable&&e.classList.remove("disabled"),a.noDisable||(e.disabled=!1),e.dataset.originalIcon?(n.className=e.dataset.originalIcon,delete e.dataset.originalIcon):n&&n.remove()}function j(e,t){const a=new URL(window.location.href);for(let t in e)a.searchParams.set(t,e[t]);return t&&window.history.replaceState({path:a.href},"",a.href),a}function k(e){$("input",e).each((function(){const e=$(this);if(e.hasClass("exclude-on-clear"))return;const t=e.attr("type");"radio"==t||"checkbox"==t?(e.prop("checked",!1),e.hasClass("radio-qua-qua")&&$('[for="'+e.attr("id")+'"]').removeClass("btn-warning").addClass("btn-secondary")):e.val(null)})),$("textarea",e).each((function(){const e=$(this);e.hasClass("exclude-on-clear")||e.val(null)})),$("select",e).each((function(){const e=$(this);e.hasClass("exclude-on-clear")||e.val(null)})),$("option.default-selected",e).prop("selected",!0),$(".generic-file-picker .filename",e).remove(),$(".generic-file-picker label",e).html('<i class="fai far fa-upload"></i> &nbsp;Select File'),$(".form-modal-error",e).empty(),D()}function S(e,t,a){if(Array.isArray(e))throw"Array className no longer supported";if(!e&&!t)throw"Must pass one of className, $container";null==a&&(a=new FormData),e&&e.indexOf(".")<0&&(e="."+e);const n=[];if(t&&e)$(e,t).each((function(){n.push(this)}));else if(t){["input","textarea","select",'.form-control[contenteditable="true"]'].forEach(e=>{$(e,t).each((function(){n.push(this)}))})}else $(e).each((function(){n.push(this)}));return console.log("collectFormData elements",n),$.each(n,(function(){const e=$(this);if("file"===e.attr("type")){const t=e.prop("files");for(let n of t)a.append(e.attr("name")||n.name,n)}else{if(!e.attr("name"))return;"checkbox"==e.attr("type")?e.is(":checked")?a.append(e.attr("name"),e.attr("value")||"true"):void 0===e.attr("value")||e.hasClass("false-on-unchecked")?a.append(e.attr("name"),"false"):"false"===e.attr("value")&&(console.log("ADD TRUE AS VALUE"),a.append(e.attr("name"),"true")):"radio"==e.attr("type")?e.is(":checked")&&a.append(e.attr("name"),e.val()):a.append(e.attr("name"),e.val())}})),a}function T(e,t,a){const n=(a=Object.assign({exclude:[],model:null},a||{})).model?"|"+a.model:"";for(let o in t){const r=$('[name="'+o+n+'"]',e);a.exclude.includes(o)||(["checkbox","radio"].includes(r.attr("type"))?r.prop("checked",Boolean(t[o])):r.closest(".dateme").length?r.closest(".dateme").dateme("setdate",{date:t[o]}):r.val(t[o]))}}function A(e,t){const a=e.data(),n={};for(let e in a){if($.inArray(e,t||[])>=0)continue;n[e.split(/(?=[A-Z])/).join("_").toLowerCase()]=a[e].toString()}return n}function D(e){$.each(["was-validated","is-invalid","is-valid","vindicate-validated"],(function(t,a){$("."+a,e).removeClass(a)})),$(".invalid-feedback",e).text("")}function P(e,t,a,n){return(a=a||{}).triggerBtn&&I(a.triggerBtn,!0),$.ajax(e,n).done((function(e){a.triggerBtn&&I(a.triggerBtn,!1),e.success?(t&&t(e),e.redirect&&(window.location.href=e.redirect),e.reload&&window.location.reload()):(a.onCompletedError&&a.onCompletedError(e),a.onAnyError&&a.onAnyError(e),a.silenceCompletedError||a.silenceAllErrors||(a.errorDestination?a.errorDestination.text(e.err):"undefined"!=typeof flashError?flashError(e.err):alert(e.err)))})).fail((function(){if(a.triggerBtn&&I(a.triggerBtn,!1),a.onFailError&&a.onFailError(...arguments),a.onAnyError&&a.onAnyError(...arguments),!a.silenceFailError&&!a.silenceAllErrors){const e="A problem occurred communicating with the server. Please try again and contact us if the problem recurs.";a.errorDestination?a.errorDestination.text(e):"undefined"!=typeof flashError?flashError(e):alert(e)}}))}function O(e,t,a,n){return P(e,a,n,{method:"GET",data:t})}function F(e,t,a,n){const o={method:"POST",data:t};return t instanceof FormData&&(o.processData=!1,o.contentType=!1),P(e,a,n,o)}$(".postme").click((function(){const e=$(this),t=A(e,["url","confirm-message"]);if(!e.data("url"))throw".postme requires data-url";e.data("confirm-message")&&!confirm(e.data("confirm-message"))||F(e.data("url"),t,(function(t){t.success_message&&p(t.success_message),e.hasClass("auto-reload")&&window.location.reload()}),{triggerBtn:e})}));const B={},M={showSuccess:!1,strictValidation:["casenum"],formats:{decimalwithcomma:{regex:/^\d+(?:\.\,\d+)?$/,message:"Please enter a decimal value (xxx.xx)"},password:{regex:/^(?=.*[a-z])(?=.*[A-Z])(?=.{8,})/}},validationStates:{invalid:{parent:"is-invalid"},warning:{parent:"is-invalid"}}},N={validated:"vindicateValidated",valid:"vindicateValid",invalid:"vindicateInvalid",submitSuccess:"vindicateform.submitSuccess",submitError:"vindicateform.submitError"};$(()=>{$(".vindicate-form").each((function(){const e=$(this);if(e.vindicate("init",M),e.hasClass("has-upload")){let t=v();e.data("randkey",t);let a=window.tfcui.MultiUploader($(".tfcui-multiuploader",e),{allowMultiple:e.hasClass("upload-multiple"),pathGeneratorURL:e.data("path-generator-url"),uploadContext:e.data("upload-context")});B[t]=a}})),$(".vindicate-form-submit").click((function(e){const t=$(this),a=t.closest(".vindicate-form");if(a.is("form"))return console.log("skipping form"),!0;I(t,!0),a.vindicate("validate")?a.trigger(N.valid,[t]):(e.preventDefault(),I(t,!1),$(".vindicate-form-error",a).each((e,t)=>{(t=$(t)).text("There is a problem with your submission. Please see feedback "+(t.data("feedback-direction")||"above")+".")}),a.trigger(N.invalid)),a.trigger(N.validated,[t]),a.addClass("vindicate-validated")})),$("form.vindicate-form").on("submit",(function(e){console.log("SUBMIT EVENT");const t=$(this),a=$(".vindicate-form-submit",t);return I(a,!0),t.vindicate("validate")?(console.log("trigger from submit",t),t.trigger(N.valid),t.trigger(N.validated),t.addClass("vindicate-validated"),!0):(e.preventDefault(),I(a,!1),console.log("trigger invalid"),$(".vindicate-form-error",t).each((e,t)=>{(t=$(t)).text("There is a problem with your submission. Please see feedback "+(t.data("feedback-direction")||"above")+".")}),t.trigger(N.invalid),!1)})),$(".vindicate-form.auto-submit").on(N.valid,(function(e,t){const a=$(this),n=new FormData;let o=null;if(e.stopPropagation(),console.log("SUBMIT",a,t),a.is("form"))a.submit();else if(a.data("form-class")?S(a.data("form-class"),a,n):S(null,a,n),a.hasClass("has-upload")){if(o=B[a.data("randkey")],!o)throw"Unexpected error: multiuploader does not exist";o.startUpload().then((function(e){e.numFailed?($(".form-modal-error,.vindicate-form-error",a).text("One or more file uploads failed. Submission cancelled."),I(t,!1)):($.each(e.succeededS3Paths,(function(e,t){n.append("upload_path",t)})),r())}),(function(e){console.error("Error from MultiUploader",e),$(".form-modal-error,.vindicate-form-error",a).text("One or more file uploads failed. Submission cancelled."),I(t,!1)}))}else r();function r(){F(t.data("submit-url")||a.data("submit-url"),n,(function(e){a.hasClass("auto-reload")&&window.location.reload(),!o||e.redirect||e.reload||o.reset(),a.trigger(N.submitSuccess)}),{triggerBtn:t,onAnyError:function(){a.trigger(N.submitError)}})}})),$(".form-modal .vindicate-form").on(N.invalid,(function(e){console.log("form modal invalid",$(this)),e.stopPropagation(),$(".form-modal-error",$(this)).text("Validation errors occurred. Please see feedback above.")}))});const U=o,L=n,V=l,_=r,H=i}]);